<link rel="import" href="../../bower_components/polymer/polymer.html"/>
<link rel="import" href="../../dist/ff-core.html"/>
<link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Open+Sans:400' type='text/css'>
<link rel="stylesheet" href="../../bower_components/components-font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="../../bower_components/bootstrap/dist/css/bootstrap.min.css">

<dom-module id="sd-search-box">
    <template>
        <link rel="stylesheet" href="../../bower_components/bootstrap/dist/css/bootstrap.min.css">
        <style>
            :host {
                display: block;
                margin: 10px 0;
            }
        </style>
        <!--<form>-->
            <div class="input-group row">
                <input type="text" id="searchbox" class="form-control" placeholder="Search" on-keyup="enterSearch" autofocus>
                <div class="input-group-btn">
                    <button class="btn btn-default" on-tap="fireSearchEvent">
                        <i class="glyphicon glyphicon-search"></i> Search
                    </button>
                </div>
            </div>
        <!--</form>-->
    </template>
</dom-module>
<script>
    class SdSearchBox extends Polymer.Element {

        constructor() {
            super();
        }

        static get is() {
            return "sd-search-box";
        }

        fireSearchEvent() {
            console.log("search");
            factfinder.communication.FFCommunicationEventAggregator.addFFEvent({
                type: "search",
                query: this.$.searchbox.value
            });
            factfinder.communication.FFCommunicationEventAggregator.addFFEvent({
                type: "search",
                channel: "webc-doku-api",
                query: this.$.searchbox.value,
                topics: function () {
                    return ["customSearch", "specialElement"];
                }
            });
        }

        enterSearch(event) {
            if (event.code === 'Enter') {
                this.fireSearchEvent();
            }
        }

        // noinspection JSUnusedGlobalSymbols
        connectedCallback() {
            super.connectedCallback();
        }

    }

    customElements.define(SdSearchBox.is, SdSearchBox);

</script>