<link rel="import" href="../../bower_components/polymer/polymer.html"/>

<dom-module id="sd-record">
    <template>
        <link rel="stylesheet" href="../../bower_components/bootstrap/dist/css/bootstrap.css">
        <style>
            .panel:hover {
                cursor: pointer;
            }
        </style>
        <template is="dom-repeat" items="{{records}}" restamp="true" on-dom-change="labelize">
            <div class="row">
                <div class="panel panel-default" on-tap="goToDeeplink">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            API-Reference: {{item.record.title}}
                        </h3>
                    </div>
                    <div class="panel-body">
                        <b>Methods</b>
                        <span class="labelize">{{item.record.methods}}</span>
                        <b>Mixins</b>
                        <span class="labelize">{{item.record.mixins}}</span>
                        <b>Properties</b>
                        <span class="labelize">{{item.record.property}}</span>
                    </div>
                </div>
            </div>
        </template>
    </template>
</dom-module>

<script>
    class SdRecord extends Polymer.Element {

        constructor() {
            super();
        }

        static get properties() {
            return {
                records: {
                    type: Array
                }
            }
        }

        static get is() {
            return "sd-record";
        }

        labelize() {
            let nodes = this.shadowRoot.querySelectorAll(".labelize");
            for (let i = 0; i < nodes.length; i++) {
                let item = nodes.item(i);
                let text = item.innerHTML;
                item.innerHTML = "";
                text.split(" ").forEach(t => {
                    item.innerHTML += "<span class=\"label label-primary\">" + t + "</span>";
                });
                item.classList.remove("labelize");
            }
        }

        goToDeeplink(e) {
            if (e.model.__data.item.record.deeplink !== "") {
                window.open(e.model.__data.item.record.deeplink, "_blank")
            }
        }
    }

    customElements.define(SdRecord.is, SdRecord);

</script>